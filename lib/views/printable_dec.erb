<style>
  @page
  {
    size: auto;
    margin: 0mm;
  }

  * {
    -webkit-print-color-adjust: exact !important;
    color-adjust: exact !important;
  }

  table {
    width: 100%;
    border-collapse: collapse;
    font-family: sans-serif;
    border-spacing: 0;
    border: none;
    margin-bottom: 20px;
  }

  table tr, table tr td, table tr th {
    vertical-align: top;
    text-align: left;
    padding: 0;
  }

  table th, table td {
    font-size: 14px;
  }

  table.split table:last-child {
    margin-bottom: 0;
  }

  table.split {
    margin-bottom: 0;
  }

  table.split > tbody > tr > td {
    width: 50%;
    padding-right: 15px;
  }

  table.split > tbody > tr > td:last-child {
    padding-right: 0;
    padding-left: 15px;
  }

  table.accentuate {
    background: #1d70b8;
    color: #fff;
  }

  table.accentuate table {
    color: #fff;
  }

  table.numerical tbody tr td {
    text-align: right;
  }

  table.numerical thead tr th:not(:first-child) {
    text-align: right;
  }

  table.header {
    background: #000;
    color: #fff;
    line-height: 52px;
  }

  table.header h1.govuk-heading-m {
    color: #fff;
    margin: 0;
    padding: 0;
    line-height: 52px;
  }

  table.accentuate p.govuk-body {
    color: #fff;
  }

  table.accentuate > tbody > tr > td {
    padding: 20px;
    border-left: 1px solid #fff;
  }

  table.accentuate > tbody > tr > td:first-child {
    border-left: none;
  }

  td.giant-letter {
    text-align: center;
  }

  td.giant-letter span {
    font-size: 50px;
  }

  table.greybox {
    background: #eee;
    margin-bottom: 20pX;
  }

  table.greybox > tbody > tr > td {
    padding: 15px;
  }

  table.border-bottom tr td, table.border-bottom tr th {
    border-bottom: 1px solid #ccc;
    padding: 5px;
  }

  table.border-bottom tr td:first-child, table.border-bottom tr th:first-child {
    padding-left: 0;
  }

  table.border-bottom tr td:last-child, table.border-bottom tr th:last-child {
    padding-right: 0;
  }

  table.accentuate table.border-bottom tr td, table.accentuate table.border-bottom tr th {
    border-bottom-color: #fff;
  }

  table.border-bottom tbody tr:last-child td, table.border-bottom tbody tr:last-child th {
    border-bottom: none;
  }

  table > tbody > tr > td > table.border-bottom {
    margin-bottom: 0;
  }

  table.border-bottom h3, table.border-bottom p {
    margin: 0!important;
    padding: 0!important;
  }

  .arrow {
    display: inline-block;
    line-height: 30px;
    color: #fff;
    padding-right: 10px;
    position: relative;
    width: 75px;
    text-align: center;
  }

  .arrow:before, .arrow:after {
    width: 0;
    height: 0;
    border-style: solid;
    border-width: 17px 17px 0 0;
    border-color: #eee transparent transparent transparent;
    content: "";
    float: left;
    margin-top: -1px;
    margin-left: -1px;
    display: block;
  }

  .arrow:after {
    position: absolute;
    border-width: 17px 0 0 17px;
    border-color: transparent transparent transparent #eee;
    float: none;
    bottom: -1px;
    left: 0;
  }


  .hm-gov-crest {
    height: 52px;
    padding: 5px;
    float: right;
  }

  .small-font {
    font-size: 12px;
  }

  .band-a{
    background: #008054
  }

  .band-b{
    background: #19b459
  }

  .band-c{
    background: #8dce46
  }

  .band-d{
    background: #ffd500
  }

  .band-e{
    background: #fcaa65
  }

  .band-f{
    background: #ef8023
  }

  .band-g{
    background: #e9153b
  }

  @-moz-document url-prefix() {
    h1.govuk-heading-m {
      font-size: 20px;
    }

    table.accentuate, table.accentuate table, table.header, table.header h1.govuk-heading-m, table.accentuate p.govuk-body {
      color: transparent;
      text-shadow: 0 0 0 #fff;
    }

    table.split > tbody > tr > td:first-child {
      padding: 0!important;
    }

    table.split > tbody > tr > td:first-child p {
      margin: 0!important;
      padding: 0!important;
    }

    .arrow {
      width: auto;
    }
  }

  @media not all and (min-resolution:.001dpcm) {
    @media {
      h1.govuk-heading-m {
        font-size: 20px;
      }

      h2.govuk-heading-s {
        margin-bottom: 5px;
      }

      p.govuk-body {
        margin-bottom: 10px;
      }

      svg[role="img"] {
        zoom: 0.70;
      }

      table {
        margin-bottom: 15px;
      }

      table.greybox {
        margin-bottom: 10px;
      }

      table.greybox > tbody > tr > td {
        padding: 5px;
      }
    }
  }

</style>

<table class="govuk-body govuk-!-margin-bottom-0">
  <tbody>
  <tr>
    <td>
      <a
        href="<%= localised_url("/energy-certificate/" + assessment[:assessmentId])%>"
        class="govuk-back-link">
        <%=t('layout.body.breadcrumb.back')%>
      </a>

      <table class="header">
        <tbody>
          <tr>
            <td>
              <h1 class="govuk-heading-m" style="padding-left: 15px; margin: 5px"><%= t('dec.top_heading') %>
              </h1>
            </td>
            <td>
              <img src="/images/hm-gov-and-crest.png" class="hm-gov-crest" alt="HM Government">
            </td>
          </tr>
        </tbody>
      </table>
    </td>
  </tr>

  <tr>
    <td>
      <table class="accentuate">
        <tbody>
          <tr>
            <td>
              <p class="<%= address_size(assessment[:address]) %>">

                <%== [assessment[:address][:addressLine1],
                     assessment[:address][:addressLine2],
                     assessment[:address][:addressLine3],
                     assessment[:address][:addressLine4],
                     assessment[:address][:town],
                     assessment[:address][:postcode]].reject(&:nil?).reject(&:empty?).join('<br />') %>
              </p>
            </td>
            <td class="giant-letter">
              <%= t('dec.sections.previous_energy_ratings.energy_rating') %><br />
              <span><%= assessment[:currentAssessment][:energyEfficiencyBand].upcase %></span>
            </td>
            <td>
              <table class="border-bottom">
                <tbody>
                  <tr>
                    <th><%= t('dec.sections.contents.certificate_number') %>:</th>
                    <td><%= assessment[:assessmentId] %></td>
                  </tr>
                  <tr>
                    <th><%= t('dec.sections.administrative_information.valid_until') %>:</th>
                    <td><%= assessment[:dateOfExpiry] %></td>
                  </tr>
                  <tr>
                    <th><%= t('dec.sections.technical_information.floor_area') %>:</th>
                    <td><%= assessment[:technicalInformation][:floorArea] %> square metres</td>
                  </tr>
                </tbody>
              </table>
            </td>
          </tr>
        </tbody>
      </table>
    </td>
  </tr>

  <tr>
    <td>
      <table class="split">
        <tbody>
        <tr>
          <td>
            <h2 class="govuk-heading-s"><%= t('dec.sections.rating.title') %></h2>
            <p class="govuk-body"><%= t('dec.sections.rating.emissions_text') %></p>
            <p class="govuk-body"><%= t('dec.sections.rating.text') %></p>
            <p class="govuk-body"><%= t('dec.sections.rating.typical_text') %></p>

            <table>
              <tbody>
                <tr>
                  <td>
                    <%== erb :printable_dec__svg_rating, locals: {
                      title: t('dec.sections.rating.svg_title', energy_efficiency_band: assessment[:energyEfficiencyBand], energy_efficiency_rating: assessment[:energyEfficiencyRating]),
                      energy_efficiency_band: assessment[:currentAssessment][:energyEfficiencyBand],
                      energy_efficiency_rating: assessment[:currentAssessment][:energyEfficiencyRating],
                      show_on_non_print: true
                    } %>
                  </td>
                </tr>
              </tbody>
            </table>

            <table class="greybox">
              <tbody>
                <tr>
                  <td>
                    <h3 class="govuk-heading-s"><%= t('dec.sections.technical_information.print_title') %></h3>
                    <table class="border-bottom numerical">
                      <thead>
                        <tr>
                          <td><%= t('dec.sections.technical_information.energy_use') %></td>
                          <th><%= t('dec.sections.technical_information.electricity') %></th>
                          <th><%= t('dec.sections.technical_information.other_fuels') %></th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <th>
                            <%= t('dec.sections.technical_information.annual_energy_use') %>
                          </th>
                          <td>
                            <%= assessment[:technicalInformation][:annualEnergyUseElectrical] %>
                          </td>
                          <td>
                            <%= assessment[:technicalInformation][:annualEnergyUseFuelThermal] %>
                          </td>
                        </tr>
                        <tr>
                          <th>
                            <%= t('dec.sections.technical_information.typical_energy_use') %>
                          </th>
                          <td>
                            <%= assessment[:technicalInformation][:typicalElectricalUse] %>
                          </td>
                          <td>
                            <%= assessment[:technicalInformation][:typicalThermalUse] %>
                          </td>
                        </tr>
                        <tr>
                          <th>
                            <%= t('dec.sections.technical_information.energy_from_renewables') %>
                          </th>
                          <td>
                            <%= assessment[:technicalInformation][:renewablesElectrical] %>%
                          </td>
                          <td>
                            <%= assessment[:technicalInformation][:renewablesFuelThermal] %>%
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </td>
                </tr>
              </tbody>
            </table>
          </td>
          <td>
            <table class="greybox">
              <tbody>
                <tr>
                  <td>
                    <h2 class="govuk-heading-s"><%= t('dec.sections.previous_energy_ratings.title') %></h2>
                    <table class="border-bottom">
                        <tr>
                          <th><%= t('dec.sections.previous_energy_ratings.date') %></th>
                          <th><%= t('dec.sections.previous_energy_ratings.energy_rating') %></th>
                        </tr>
                      </thead>
                      <tbody>
                        <% [assessment[:currentAssessment], assessment[:year1Assessment], assessment[:year2Assessment]].each do |previous_rating| %>
                          <% next if previous_rating.values.include?(nil) %>
                          <tr>
                            <th class="govuk-!-padding-top-2">
                              <%=Date.parse(previous_rating[:date]).strftime("%B %Y")%>
                            </th>
                            <td>
                              <div class="arrow band-<%= previous_rating[:energyEfficiencyBand] %>">
                                <%= previous_rating[:energyEfficiencyRating] %> | <%= previous_rating[:energyEfficiencyBand].upcase %>
                              </div>
                            </td>
                          </tr>
                        <% end %>
                      </tbody>
                    </table>
                  </td>
                </tr>
              </tbody>
            </table>


            <table class="greybox">
              <tbody>
                <tr>
                  <td>
                    <h2 class="govuk-heading-s"><%= t('dec.sections.co2.title') %></h2>
                    <p class="govuk-body"><%= t('dec.sections.co2.explanation') %></p>
                    <table class="border-bottom numerical">
                      <thead>
                        <tr>
                          <th><%= t('dec.sections.co2.col.date') %></th>
                          <th><%= t('dec.sections.co2.col.electricity') %></th>
                          <th><%= t('dec.sections.co2.col.heating') %></th>
                          <th><%= t('dec.sections.co2.col.renewables') %></th>
                        </tr>
                      </thead>
                      <tbody>
                        <% [assessment[:currentAssessment], assessment[:year1Assessment], assessment[:year2Assessment]].each do |previous_rating| %>
                          <% next if previous_rating.values.include?(nil) %>
                          <tr>
                            <th>
                              <%=Date.parse(previous_rating[:date]).strftime("%B %Y")%>
                            </th>
                            <td>
                              <%= previous_rating[:electricityCo2] || t('dec.sections.co2.no_value') %>
                            </td>
                            <td>
                              <%= previous_rating[:heatingCo2] || t('dec.sections.co2.no_value') %>
                            </td>
                            <td>
                              <%= previous_rating[:renewablesCo2] || t('dec.sections.co2.no_value') %>
                            </td>
                          </tr>
                        <% end %>
                      </tbody>
                    </table>
                  </td>
                </tr>
              </tbody>
            </table>

            <h2 class="govuk-heading-s"><%= t('dec.sections.administrative_information.print_title') %></h2>
            <table class="border-bottom">
              <tbody>
                <% {
                   "assessor.list.name": assessment[:assessor][:name],
                   "scheme_name": scheme_details(assessment[:assessor], 'name'),
                   "company_name": assessment[:assessor][:companyDetails][:name],
                   "company_address": assessment[:assessor][:companyDetails][:address],
                   "issue_date": date(assessment[:administrativeInformation][:issueDate]),
                   "nominated_date": date(assessment[:currentAssessment][:date]),
                   "related_party_disclosure": party_disclosure(
                     (assessment[:administrativeInformation][:relatedPartyDisclosure].nil? ?
                       "8" :
                       assessment[:administrativeInformation][:relatedPartyDisclosure]), "", "dec_disclosure_code", "dec"
                   )
                   }.each do |key, value| %>
                  <tr>
                    <th>
                      <%= t("dec.sections.administrative_information." + key.to_s) %>
                    </th>
                    <td>
                      <%= value %>
                    </td>
                  </tr>
                <% end %>
              </tbody>
            </table>
          </td>
        </tr>
        </tbody>
      </table>
    </td>
  </tr>
  </tbody>
</table>
<script>
  window.onload = function() {
    window.print();
  }
</script>
